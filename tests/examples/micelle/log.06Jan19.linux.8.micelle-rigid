LAMMPS (4 Jan 2019)
# 2d micelle simulation

dimension	2

neighbor	0.3 bin
neigh_modify	delay 5

atom_style	bond

# Soft potential push-off

read_data	data.micelle
  orthogonal box = (0 0 -0.1) to (35.8569 35.8569 0.1)
  4 by 2 by 1 MPI processor grid
  reading atoms ...
  1200 atoms
  scanning bonds ...
  1 = max bonds/atom
  reading bonds ...
  300 bonds
  2 = max # of 1-2 neighbors
  1 = max # of 1-3 neighbors
  1 = max # of 1-4 neighbors
  2 = max # of special neighbors
special_bonds	fene
  2 = max # of 1-2 neighbors
  2 = max # of special neighbors

pair_style	soft 1.12246
pair_coeff	* * 0.0 1.12246

bond_style 	harmonic
bond_coeff	1 50.0 0.75

velocity	all create 0.45 2349852

variable	prefactor equal ramp(1.0,20.0)

fix		1 all nve
fix		2 all temp/rescale 100 0.45 0.45 0.02 1.0
fix		3 all adapt 1 pair soft a * * v_prefactor
fix		4 all enforce2d

thermo		50
run		1000
Neighbor list info ...
  update every 1 steps, delay 5 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 1.42246
  ghost atom cutoff = 1.42246
  binsize = 0.71123, bins = 51 51 1
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair soft, perpetual
      attributes: half, newton on
      pair build: half/bin/newton
      stencil: half/bin/2d/newton
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 3.75 | 3.843 | 4.122 Mbytes
Step Temp E_pair E_mol TotEng Press 
       0         0.45   0.40003481 2.2200223e-06   0.84966203   0.78952518 
      50   0.47411013   0.67721272  0.057404514    1.2083323    1.3375852 
     100         0.45   0.73046745  0.054836584     1.234929    2.3196516 
     150   0.67521742   0.72402001  0.043490075    1.4421648    2.8744416 
     200         0.45   0.78481891  0.076931503    1.3113754    3.0412388 
     250   0.66479018   0.69790602  0.081075564    1.4432178    3.6917024 
     300         0.45   0.76820218  0.066727591    1.2845548    3.7861054 
     350   0.67619136     0.625715  0.072722727    1.3740656    4.2861621 
     400         0.45   0.68527759  0.090724527    1.2256271    4.4725214 
     450   0.56702844   0.64402767  0.080555563    1.2911391    4.7402211 
     500         0.45   0.64883009  0.078376672    1.1768318    4.7919294 
     550     0.564664   0.58260368  0.080779475    1.2275766    4.9855705 
     600         0.45   0.58193041  0.088386617     1.119942     5.131481 
     650   0.52110993    0.5415273  0.097683746    1.1598867    5.2500294 
     700         0.45   0.50856787  0.088471208    1.0466641    5.2550165 
     750   0.51510855   0.47441291  0.089429375    1.0785216     5.375763 
     800         0.45   0.49926696  0.085958476    1.0348504    5.4665914 
     850   0.50688494   0.46614429  0.088962292    1.0615691     5.556932 
     900         0.45   0.47785593   0.10150857    1.0289895    5.7765975 
     950   0.49590559   0.46050477  0.096404887     1.052402    5.8649245 
    1000         0.45   0.47691182   0.08808163    1.0146185    6.0177568 
Loop time of 0.0437969 on 8 procs for 1000 steps with 1200 atoms

Performance: 9863708.412 tau/day, 22832.658 timesteps/s
99.0% CPU use with 8 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.012425   | 0.013708   | 0.015196   |   0.9 | 31.30
Bond    | 0.00069724 | 0.00081135 | 0.00094708 |   0.0 |  1.85
Neigh   | 0.0040697  | 0.0041005  | 0.0041389  |   0.0 |  9.36
Comm    | 0.01544    | 0.016946   | 0.018436   |   0.9 | 38.69
Output  | 0.00047266 | 0.00048447 | 0.00051842 |   0.0 |  1.11
Modify  | 0.0042518  | 0.004611   | 0.0048656  |   0.4 | 10.53
Other   |            | 0.003135   |            |       |  7.16

Nlocal:    150 ave 154 max 144 min
Histogram: 1 0 0 0 1 0 2 2 1 1
Nghost:    79 ave 84 max 75 min
Histogram: 1 1 1 0 3 0 0 0 1 1
Neighs:    392 ave 417 max 363 min
Histogram: 1 0 1 0 1 1 2 1 0 1

Total # of neighbors = 3136
Ave neighs/atom = 2.61333
Ave special neighs/atom = 0.5
Neighbor list builds = 92
Dangerous builds = 0

unfix		3

# Main run

pair_style	lj/cut 2.5

# solvent/head - full-size and long-range

pair_coeff	1 1 1.0 1.0 2.5
pair_coeff	2 2 1.0 1.0 2.5
pair_coeff	1 2 1.0 1.0 2.5

# tail/tail - size-averaged and long-range

pair_coeff	3 3 1.0 0.75 2.5
pair_coeff	4 4 1.0 0.50 2.5
pair_coeff	3 4 1.0 0.67 2.5

# solvent/tail - full-size and repulsive

pair_coeff	1 3 1.0 1.0 1.12246
pair_coeff	1 4 1.0 1.0 1.12246

# head/tail - size-averaged and repulsive

pair_coeff	2 3 1.0 0.88 1.12246
pair_coeff	2 4 1.0 0.75 1.12246

thermo		1000

#dump		1 all atom 2000 dump.micelle

#dump		2 all image 2000 image.*.jpg type type zoom 1.6
#dump_modify	2 pad 5 adiam 1 0.5 adiam 2 1.5 adiam 3 1.0 adiam 4 0.75

#dump		3 all movie 2000 movie.mpg type type zoom 1.6
#dump_modify	3 pad 5 adiam 1 0.5 adiam 2 1.5 adiam 3 1.0 adiam 4 0.75

reset_timestep	0
group solvent   molecule 0
750 atoms in group solvent
group solute    subtract all solvent
450 atoms in group solute
unfix 1
unfix 2
unfix 4
fix		1 solvent nve
fix		2 solvent temp/rescale 100 0.45 0.45 0.02 1.0
fix		5 solute rigid molecule langevin 0.45 0.45 0.5 112211
150 rigid bodies with 450 atoms
fix		4 all enforce2d
run		20000
Neighbor list info ...
  update every 1 steps, delay 5 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 2.8
  ghost atom cutoff = 2.8
  binsize = 1.4, bins = 26 26 1
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut, perpetual
      attributes: half, newton on
      pair build: half/bin/newton
      stencil: half/bin/2d/newton
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 5.247 | 5.278 | 5.371 Mbytes
Step Temp E_pair E_mol TotEng Press 
       0   0.44725304   -1.7056163   0.08808163   -1.2545143    1.3139355 
    1000   0.45788573   -1.9287824  0.088103524   -1.4690283   0.92874874 
    2000   0.43419249   -1.9167437  0.088551969   -1.4757722    5.5791514 
    3000   0.43982753   -1.9430388  0.090153361   -1.4958921    2.6154401 
    4000   0.44876419   -1.9732644  0.088949915   -1.5200676   -1.0596639 
    5000   0.44692862    -1.986259  0.088178141   -1.5353238    1.9598857 
    6000   0.45303996   -1.9840968  0.088735305    -1.527644    2.1744123 
    7000    0.4379539   -1.9861796  0.088662207   -1.5420449    3.6283505 
    8000   0.43674797   -1.9962789  0.088079252   -1.5537058   -6.0793015 
    9000   0.44642525   -2.0063379  0.089152717   -1.5548366    5.0039439 
   10000   0.45077837    -2.029832  0.088698049   -1.5752522    1.2397681 
   11000   0.44819761   -2.0341702  0.088394128    -1.581989   -1.7160626 
   12000   0.44856578   -2.0321857  0.087814701   -1.5802851   -1.7078672 
   13000   0.45787917   -2.0318623  0.087776274   -1.5724407    3.3283655 
   14000   0.44875971   -2.0446045   0.08821179   -1.5921494   -2.2278699 
   15000   0.44300252   -2.0181032  0.088466119   -1.5700667   -2.3449279 
   16000   0.46233981    -2.031343   0.08853962   -1.5675376   0.03978392 
   17000   0.43417681   -2.0400732  0.088301313   -1.5993651   -4.9288319 
   18000   0.43936268    -2.052866  0.088581074   -1.6076689   -1.0852206 
   19000   0.43957624   -2.0435336   0.08797097   -1.5987732   0.83818051 
   20000   0.45248215   -2.0579328  0.087890885   -1.6027772  -0.62736221 
Loop time of 3.25471 on 8 procs for 20000 steps with 1200 atoms

Performance: 2654612.357 tau/day, 6144.936 timesteps/s
96.9% CPU use with 8 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.31591    | 0.32947    | 0.34508    |   1.9 | 10.12
Bond    | 0.014279   | 0.017917   | 0.021581   |   1.8 |  0.55
Neigh   | 0.14       | 0.14154    | 0.14394    |   0.4 |  4.35
Comm    | 0.40469    | 0.42995    | 0.4592     |   3.0 | 13.21
Output  | 0.00052751 | 0.00054539 | 0.00063025 |   0.0 |  0.02
Modify  | 2.1824     | 2.2092     | 2.2646     |   2.0 | 67.88
Other   |            | 0.1261     |            |       |  3.87

Nlocal:    150 ave 158 max 138 min
Histogram: 1 0 0 1 2 0 0 0 3 1
Nghost:    169.625 ave 180 max 152 min
Histogram: 1 0 0 2 0 0 0 2 0 3
Neighs:    1121.25 ave 1205 max 1030 min
Histogram: 1 1 0 0 1 1 2 1 0 1

Total # of neighbors = 8970
Ave neighs/atom = 7.475
Ave special neighs/atom = 0.5
Neighbor list builds = 1572
Dangerous builds = 0
unfix 5
unfix 4
fix		5 solute rigid/small molecule langevin 0.45 0.45 0.5 112211
150 rigid bodies with 450 atoms
  36.5274 = max distance from body owner to body atom
fix		4 all enforce2d
run		20000
Per MPI rank memory allocation (min/avg/max) = 8.544 | 8.579 | 8.674 Mbytes
Step Temp E_pair E_mol TotEng Press 
   20000   0.45248215   -2.0579328  0.087890885   -1.6027772   0.83730717 
   21000    0.4404188   -2.0486605  0.088488832   -1.6026985    7.3367325 
   22000   0.42704978   -2.0453845  0.089992405     -1.60877    1.7827964 
   23000   0.44290593   -2.0519793  0.088822963   -1.6036644   -2.6957579 
   24000   0.46216919   -2.0429412  0.088076276   -1.5797376  -0.68489332 
   25000   0.44301044   -2.0420018  0.087978492   -1.5944465     2.597193 
   26000   0.44937722   -2.0387529  0.088760241   -1.5852482   0.77795293 
   27000   0.45528396   -2.0489727  0.088513473   -1.5909204   -3.1709677 
   28000   0.44989687   -2.0375571  0.088733316   -1.5836575   0.53232458 
   29000   0.47363413   -2.0458244  0.088718811   -1.5726725   0.43258842 
   30000   0.44274703    -2.040167  0.088079434   -1.5927246    0.5687171 
   31000   0.44342119   -2.0512024  0.089692732   -1.6015994    4.0722263 
   32000   0.45502556   -2.0598324  0.087863429   -1.6026399   -3.5407875 
   33000   0.43665983   -2.0573286  0.088025318   -1.6148811    3.7277275 
   34000   0.45489756   -2.0916266  0.088051962   -1.6343494   -2.2170844 
   35000   0.45286468   -2.0692377  0.087829899   -1.6138326    -2.346677 
   36000   0.43556288   -2.0591294  0.089144496    -1.616453   -4.9269591 
   37000   0.45854825   -2.0824652  0.088000934   -1.6222759  -0.77432904 
   38000    0.4519482   -2.0756206  0.088299386   -1.6204899  0.018337173 
   39000   0.44858242   -2.0656206  0.087611911   -1.6139093   -2.2463794 
   40000   0.45623374   -2.0743417  0.088229291   -1.6158027    2.0963568 
Loop time of 1.80719 on 8 procs for 20000 steps with 1200 atoms

Performance: 4780915.820 tau/day, 11066.935 timesteps/s
99.8% CPU use with 8 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.3184     | 0.34276    | 0.37968    |   3.7 | 18.97
Bond    | 0.013207   | 0.017824   | 0.022403   |   2.4 |  0.99
Neigh   | 0.14917    | 0.15123    | 0.15314    |   0.4 |  8.37
Comm    | 0.39085    | 0.4219     | 0.45805    |   3.8 | 23.35
Output  | 0.00049742 | 0.00051618 | 0.00058903 |   0.0 |  0.03
Modify  | 0.77214    | 0.79432    | 0.81692    |   1.9 | 43.95
Other   |            | 0.07863    |            |       |  4.35

Nlocal:    150 ave 159 max 143 min
Histogram: 3 0 0 2 0 0 0 0 2 1
Nghost:    173.25 ave 181 max 158 min
Histogram: 1 0 1 1 0 0 0 1 0 4
Neighs:    1151.62 ave 1221 max 1080 min
Histogram: 1 0 1 2 1 0 0 1 0 2

Total # of neighbors = 9213
Ave neighs/atom = 7.6775
Ave special neighs/atom = 0.5
Neighbor list builds = 1574
Dangerous builds = 0
Total wall time: 0:00:05
